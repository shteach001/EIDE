<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>连接FTP服务器 (FTP辅助对象)</title>
</head>
<body>
<p><big><strong><font color="#000000">连接FTP服务器</font></big>&nbsp;方法</strong>&nbsp;&nbsp;&nbsp;操作系统支持：Windows、Linux&nbsp;&nbsp;&nbsp; 所属对象：<a href="dt2.htm">FTP辅助对象</a></p>
<p>连接到互联网上指定地址处的FTP服务器。成功返回真，失败返回假。</p>
<p><em>语法：</em> &nbsp;<font color="#000000">逻辑型</font>&nbsp; <em>FTP辅助对象</em>．连接FTP服务器 （<font color="#000000">FTP服务器地址</font><font color="#000000">，&nbsp;</font><font color="#000000">用户名</font><font color="#000000">，&nbsp;</font><font color="#000000">密码</font><font color="#000000">，&nbsp;</font><font color="#000000">端口</font><font color="#000000">，&nbsp;</font><font color="#000000">［</font><font color="#000000">日志回调函数</font><font color="#000000">］</font><font color="#000000">，&nbsp;</font><font color="#000000">［</font><font color="#000000">超时</font><font color="#000000">］</font><font color="#000000">）</font></p>
<table border=1 cols=2 frame=below rules=rows width="100%" bordercolorlight="#000000" bordercolordark="#FFFFFF" cellspacing="0" cellpadding="5"><tr>
<td width="30%" valign="top"><strong>参数名</strong></td>
<td width="70%" valign="top"><strong>描 述</strong></td>
</tr>
<tr>
<td width="30%" valign="top"><font color="#000000">FTP服务器地址</font></td>
<td width="70%" valign="top"><em>必需的</em>；&nbsp;文本型，初始值为“ftp://127.0.0.1/”。本参数指定FTP服务器在互联网上的地址，格式为 ftp://域名或ip/。</td>
</tr>
<tr>
<td width="30%" valign="top"><font color="#000000">用户名</font></td>
<td width="70%" valign="top"><em>必需的</em>；&nbsp;文本型，初始值为“anonymous”。本参数提供用作通过FTP服务器用户验证的用户名称，如果被省略，默认值为匿名用户名“anonymous”。</td>
</tr>
<tr>
<td width="30%" valign="top"><font color="#000000">密码</font></td>
<td width="70%" valign="top"><em>必需的</em>；&nbsp;文本型，初始值为“”。本参数提供用作通过FTP服务器用户验证的密码，如果被省略，默认值为空文本。</td>
</tr>
<tr>
<td width="30%" valign="top"><font color="#000000">端口</font></td>
<td width="70%" valign="top"><em>必需的</em>；&nbsp;整数型，初始值为“21”。本参数提供欲连接到FTP服务器上的端口号，如果被省略，默认值为标准端口 21。</td>
</tr>
<tr>
<td width="30%" valign="top"><font color="#000000">日志回调函数</font></td>
<td width="70%" valign="top"><em><font color="#808080">可选的</font></em>；&nbsp;子程序指针。注册一个回调函数，系统产生日志时会调用此函数通知用户,如果为0则不能接收日志，默认为0。回调函数需要有5个参数，第一个参数（整数型），线程信息，第二个参数（文本型），消息产生的时间。第三个参数（文本型），消息的正文。第四个参数（整数型），消息类型，参见”传送常量“第五个参数（整数型），对象信息，可以通过“取对象信息”获得下载或上传对象的信息与本参数比较，从而确定本消息属于哪个对象。</td>
</tr>
<tr>
<td width="30%" valign="top"><font color="#000000">超时</font></td>
<td width="70%" valign="top"><em><font color="#808080">可选的</font></em>；&nbsp;整数型。登录过程中数据交互的超时时间,单位为毫秒，如果忽略则默认为2000。</td>
</tr>
</table>

<p>　</p>
<p><em>参见：</em><a href="../rule.htm">语法的描述规则</a>、<a href="../datatype.htm">基本数据类型</a></p>
</body>
</html>
