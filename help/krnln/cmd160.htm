<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>锁住文件</title>
</head>
<body>
<p><big><strong><font color="#000000">锁住文件</font></big>&nbsp;命令</strong>&nbsp;&nbsp;&nbsp;操作系统支持：Windows&nbsp;&nbsp;&nbsp; 所属类别：<a href="ct13.htm">文件读写</a></p>
<p>在有若干个进程访问同一个文件的环境中，使用本命令拒绝其它用户对被打开文件中的某个区域进行读写访问。成功返回真，失败返回假。</p>
<p><em>语法：</em> &nbsp;<font color="#000000">逻辑型</font>&nbsp; 锁住文件 （<font color="#000000">欲加锁或解锁的文件号</font><font color="#000000">，&nbsp;</font><font color="#000000">欲加锁或解锁的位置</font><font color="#000000">，&nbsp;</font><font color="#000000">欲加锁或解锁的长度</font><font color="#000000">，&nbsp;</font><font color="#000000">［</font><font color="#000000">加锁重试时间</font><font color="#000000">］</font><font color="#000000">）</font></p>
<table border=1 cols=2 frame=below rules=rows width="100%" bordercolorlight="#000000" bordercolordark="#FFFFFF" cellspacing="0" cellpadding="5"><tr>
<td width="30%" valign="top"><strong>参数名</strong></td>
<td width="70%" valign="top"><strong>描 述</strong></td>
</tr>
<tr>
<td width="30%" valign="top"><font color="#000000">欲加锁或解锁的文件号</font></td>
<td width="70%" valign="top"><em>必需的</em>；&nbsp;整数型。该文件号由“打开文件”命令所返回。</td>
</tr>
<tr>
<td width="30%" valign="top"><font color="#000000">欲加锁或解锁的位置</font></td>
<td width="70%" valign="top"><em>必需的</em>；&nbsp;整数型。位置值从 0 开始。</td>
</tr>
<tr>
<td width="30%" valign="top"><font color="#000000">欲加锁或解锁的长度</font></td>
<td width="70%" valign="top"><em>必需的</em>；&nbsp;整数型。</td>
</tr>
<tr>
<td width="30%" valign="top"><font color="#000000">加锁重试时间</font></td>
<td width="70%" valign="top"><em><font color="#808080">可选的</font></em>；&nbsp;整数型。本参数指定加锁失败后反复进行重试的毫秒数。如果被省略，默认为 0 ，即一旦失败立即返回。如果参数值提供为 -1 ，则反复进行重试，直到加锁成功为止。</td>
</tr>
</table>

<p>　</p>
<p><em>参见：</em><a href="../rule.htm">语法的描述规则</a>、<a href="../datatype.htm">基本数据类型</a></p>
</body>
</html>
